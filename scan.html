<!DOCTYPE html>
<html dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zana Adam - Smart POS System</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        :root { --p: #1e3a8a; --s: #3b82f6; --a: #f43f5e; --bg: #f8fafc; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: var(--bg); margin: 0; padding: 20px; }
        .main-container { max-width: 1100px; margin: auto; display: grid; grid-template-columns: 1fr 420px; gap: 20px; }
        .card { background: white; border-radius: 15px; padding: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        .header { grid-column: 1/-1; text-align: center; padding: 20px; background: var(--p); color: white; border-radius: 15px; }
        label { display: block; margin-top: 15px; font-weight: bold; color: var(--p); }
        input, select { width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 10px; margin-top: 5px; font-size: 16px; box-sizing: border-box; }
        .qty-box { display: flex; gap: 10px; margin-top: 15px; align-items: flex-end; }
        .btn-add { background: var(--s); color: white; border: none; padding: 12px 25px; border-radius: 10px; cursor: pointer; font-weight: bold; flex: 1; height: 48px; }
        .cart-item { display: flex; justify-content: space-between; align-items: center; padding: 10px; border-bottom: 1px solid #f1f5f9; background: #fff; margin-bottom: 5px; border-radius: 8px; }
        .checkout-card { position: sticky; top: 20px; border: 2px solid var(--s); }
        .total-row { display: flex; justify-content: space-between; font-size: 24px; font-weight: 800; margin: 20px 0; color: var(--a); border-top: 2px dashed #eee; padding-top: 15px; }
        .btn-checkout { background: #22c55e; color: white; border: none; padding: 18px; width: 100%; border-radius: 12px; font-size: 18px; font-weight: bold; cursor: pointer; }
        .remove-btn { color: #ef4444; cursor: pointer; background: none; border: none; font-weight: bold; }
        #receipt-area { display: none; padding: 40px; background: white; }
        @media (max-width: 850px) { .main-container { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

<div class="main-container">
    <div class="header">
        <h1 style="margin:0;">Ø³ÛŒØ³ØªÛ•Ù…ÛŒ ÙØ±Û†Ø´ØªÙ†ÛŒ Ø²Ø§Ù†Ø§ Ø¦Ø§Ø¯Û•Ù…</h1>
        <p style="margin:5px 0; opacity: 0.9;">Ø¨Û•Ø´ÛŒ Ø´Ø§Ø´Û•ÛŒ iPhone, Redmi, POCO</p>
    </div>

    <div class="card">
        <label>ğŸ‘¤ Ù†Ø§ÙˆÛŒ Ú©Ú•ÛŒØ§Ø±</label>
        <input type="text" id="custName" placeholder="Ù†Ø§ÙˆÛŒ ØªÛ•ÙˆØ§ÙˆÛŒ Ú©Ú•ÛŒØ§Ø± Ø¨Ù†ÙˆÙˆØ³Û•...">
        
        <label>ğŸ” Ú¯Û•Ú•Ø§Ù† Ø¨Û† Ù…Û†Ø¯ÛÙ„ (iPhone, Redmi, Poco)</label>
        <input type="text" id="searchInput" placeholder="Ù†Ø§ÙˆÛŒ Ù…Û†Ø¯ÛÙ„ Ù„ÛØ±Û• Ø¨Ù†ÙˆÙˆØ³Û•..." oninput="filterItems()">
        <select id="itemSelect" size="12" style="margin-top:10px;"></select>
        
        <div class="qty-box">
            <div style="flex: 1;">
                <label>ğŸ”¢ Ø¨Ú• (Ø¯Ø§Ù†Û•)</label>
                <input type="number" id="itemQty" value="1" min="1">
            </div>
            <button class="btn-add" onclick="addToCart()">â• Ø²ÛŒØ§Ø¯Ú©Ø±Ø¯Ù† Ø¨Û† Ø³Û•Ø¨Û•ØªÛ•</button>
        </div>
    </div>

    <div class="card checkout-card">
        <h3 style="margin-top:0; border-bottom: 2px solid #f1f5f9; padding-bottom: 10px;">ğŸ›’ Ø³Û•Ø¨Û•ØªÛ•ÛŒ Ú©Ú•ÛŒÙ† (Checkout)</h3>
        <div id="cart-display">
            <p style="text-align:center; color:#94a3b8; margin-top:20px;">Ø³Û•Ø¨Û•ØªÛ•Ú©Û• Ø®Ø§ÚµÛŒÛŒÛ•</p>
        </div>
        
        <div class="total-row">
            <span>Ú©Û†ÛŒ Ú¯Ø´ØªÛŒ:</span>
            <span><span id="totalPrice">0</span> Ø¯ÛŒÙ†Ø§Ø±</span>
        </div>
        
        <button class="btn-checkout" onclick="processCheckout()">ğŸ’³ ØªÛ•ÙˆØ§ÙˆÚ©Ø±Ø¯Ù†ÛŒ ÙˆÛ•Ø³Úµ</button>
    </div>
</div>

<div id="receipt-area">
    <div style="text-align:center; border-bottom: 2px solid #000; padding-bottom: 20px;">
        <h2>Ú©Û†Ú¯Ø§ÛŒ Ø²Ø§Ù†Ø§ Ø¦Ø§Ø¯Û•Ù…</h2>
        <p id="r-cust" style="font-size: 18px;"></p>
        <p id="r-date"></p>
    </div>
    <div id="r-items" style="margin-top: 20px;"></div>
    <div style="text-align:center; margin-top: 30px; font-size: 26px; font-weight: bold; border-top: 2px solid #000; padding-top: 15px;">
        Ú©Û†ÛŒ Ú¯Ø´ØªÛŒ: <span id="r-total"></span> Ø¯ÛŒÙ†Ø§Ø±
    </div>
</div>

<script>
    const products = {
        // iPhone Models
        "iPhone 6G STANDARD ZY": 19000, "iPhone 6S STANDARD ZY": 20000, "iPhone 7G STANDARD ZY": 20000,
        "iPhone 8G STANDARD ZY": 20000, "iPhone XR ZY HD+": 24000, "iPhone 11 ZY HD+": 24000,
        "iPhone 12 PRO DD OLED": 52000, "iPhone 13 ZY FULL HD": 36000, "iPhone 14 PRO GX OLED": 112000,
        "iPhone 15 PRO MAX DD OLED": 108000, "iPhone 16 PRO MAX ZY": 106000,
        // Ù…Û†Ø¯ÛÙ„Û•Ú©Ø§Ù†ÛŒ ØªØ± Ù„ÛØ±Û• Ø²ÛŒØ§Ø¯ Ø¨Ú©Û•...
        "REDMI NOTE 13 PRO PLUS ORG": 65000, "POCO X6 PRO 5G OLED": 46000
    };

    let cart = [];

    function filterItems() {
        const input = document.getElementById('searchInput').value.toLowerCase();
        const select = document.getElementById('itemSelect');
        select.innerHTML = "";
        for (let name in products) {
            if (name.toLowerCase().includes(input)) {
                let opt = document.createElement('option');
                opt.value = name;
                opt.text = `${name} - (${products[name].toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±)`;
                select.appendChild(opt);
            }
        }
    }

    function addToCart() {
        const name = document.getElementById('itemSelect').value;
        const qty = parseInt(document.getElementById('itemQty').value);
        if(!name) return alert("ØªÚ©Ø§ÛŒÛ• Ù…Û†Ø¯ÛÙ„ÛÚ© Ù‡Û•ÚµØ¨Ú˜ÛØ±Û•!");
        
        const existing = cart.find(i => i.name === name);
        if(existing) existing.qty += qty;
        else cart.push({ name, price: products[name], qty });
        
        updateCartUI();
    }

    function updateCartUI() {
        const display = document.getElementById('cart-display');
        display.innerHTML = cart.length === 0 ? '<p style="text-align:center; color:#94a3b8; margin-top:20px;">Ø³Û•Ø¨Û•ØªÛ•Ú©Û• Ø®Ø§ÚµÛŒÛŒÛ•</p>' : "";
        let total = 0;
        cart.forEach((item, index) => {
            const rowTotal = item.price * item.qty;
            total += rowTotal;
            display.innerHTML += `
                <div class="cart-item">
                    <div style="flex:1;">
                        <div style="font-weight:bold;">${item.name}</div>
                        <small>${item.price.toLocaleString()} Ã— ${item.qty}</small>
                    </div>
                    <div style="font-weight:800; margin:0 15px;">${rowTotal.toLocaleString()}</div>
                    <button class="remove-btn" onclick="removeItem(${index})">âœ•</button>
                </div>`;
        });
        document.getElementById('totalPrice').innerText = total.toLocaleString();
    }

    function removeItem(index) {
        cart.splice(index, 1);
        updateCartUI();
    }

    function processCheckout() {
        const cust = document.getElementById('custName').value;
        if(!cust || cart.length === 0) return alert("Ù†Ø§ÙˆÛŒ Ú©Ú•ÛŒØ§Ø± Ùˆ Ø³Û•Ø¨Û•ØªÛ• Ù¾Ú• Ø¨Ú©Û•ÙˆÛ•!");

        const now = new Date();
        const dateStr = now.toLocaleDateString('ku-IQ');
        const timeStr = now.toLocaleTimeString('ku-IQ', { hour: '2-digit', minute: '2-digit' });

        // Ù†ÛŒØ´Ø§Ù†Ø¯Ø§Ù†ÛŒ Ø²Ø§Ù†ÛŒØ§Ø±ÛŒ Ù„Û•Ø³Û•Ø± ÙˆÛ•Ø³ÚµÛŒ PDF
        document.getElementById('r-cust').innerText = "Ú©Ú•ÛŒØ§Ø±: " + cust;
        document.getElementById('r-date').innerText = "Ø¨Û•Ø±ÙˆØ§Ø±: " + dateStr + " | Ú©Ø§Øª: " + timeStr;
        
        let itemsHtml = "";
        let whatsappMsg = `*ÙˆÛ•Ø³ÚµÛŒ Ú©Ú•ÛŒÙ† - Ú©Û†Ú¯Ø§ÛŒ Ø²Ø§Ù†Ø§ Ø¦Ø§Ø¯Û•Ù…*%0A`;
        whatsappMsg += `*Ú©Ú•ÛŒØ§Ø±:* ${cust}%0A`;
        whatsappMsg += `*Ø¨Û•Ø±ÙˆØ§Ø±:* ${dateStr}%0A`;
        whatsappMsg += `*Ú©Ø§Øª:* ${timeStr}%0A`;
        whatsappMsg += `----------------------------%0A`;

        cart.forEach(item => {
            const rowTotal = item.price * item.qty;
            // Ø¨Û† PDF
            itemsHtml += `<div style="display:flex; justify-content:space-between; padding:12px; border-bottom:1px dashed #ccc;">
                <span>${item.name} (${item.qty} Ø¯Ø§Ù†Û•)</span>
                <span>${rowTotal.toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</span>
            </div>`;
            // Ø¨Û† ÙˆØ§ØªØ³Ø¦Ø§Ù¾
            whatsappMsg += `ğŸ“± *${item.name}*%0A`;
            whatsappMsg += `ğŸ”¢ Ø¨Ú•: ${item.qty} Ã— ${item.price.toLocaleString()}%0A`;
            whatsappMsg += `ğŸ’° Ù†Ø±Ø®: ${rowTotal.toLocaleString()} Ø¯.Ú©%0A`;
            whatsappMsg += `----------------------------%0A`;
        });

        document.getElementById('r-items').innerHTML = itemsHtml;
        const finalTotal = document.getElementById('totalPrice').innerText;
        document.getElementById('r-total').innerText = finalTotal;
        whatsappMsg += `*Ú©Û†ÛŒ Ú¯Ø´ØªÛŒ Ú©Û†ØªØ§ÛŒÛŒ: ${finalTotal} Ø¯ÛŒÙ†Ø§Ø±*`;

        // Ø¯Ø±ÙˆØ³ØªÚ©Ø±Ø¯Ù†ÛŒ PDF
        const element = document.getElementById('receipt-area');
        element.style.display = 'block';
        html2pdf().from(element).save(`Zana-Adam-${cust}.pdf`).then(() => {
            element.style.display = 'none';
        });

        // Ú©Ø±Ø¯Ù†Û•ÙˆÛ•ÛŒ ÙˆØ§ØªØ³Ø¦Ø§Ù¾
        window.open(`https://wa.me/9647758887488?text=${whatsappMsg}`, '_blank');
    }

    filterItems();
</script>

</body>
</html>
